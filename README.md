# Introduction 
TODO: Give a short introduction of your project. Let this section explain the objectives or the motivation behind this project. 

# Getting Started
Clone the github repo
```
git clone
cd RemoteSensingFoundationModels
```
create python environment and install the requirements
```
python3 -m venv env
source env/bin/activate
pip install -r Spectral-Extension/requirements.txt
pip install tensorflow
pip install tensorboardX
```
## Data
add data in to a folder in the following format
```bash
├── path/to/data
│   ├── Landsat
|       ├── [LS_file_name]_dw_sample_num.tif
│   ├── S2_aligned
|       ├── [S2_file_name]_dw_sample_num.tif
```

The dataset can be generated by using the following commands
```
cp farmvibes-download/dynamic_world_samples.geojson Spectral-Extension/gen_data
cd Spectral-Extension/gen_data
python make_medium_dataset.py
```
make sure that the generated images are in the right folder and the name of the folder is correct before using them.

## Model Weights
Download the model weights (for both spectral extension and super resolution) from the storage and download them to any path of youe choice
Recommended: 
```
mkdir weights
cd weights
```
There will be one file for the spectral extension model weights ['checkpoint_E[epoch_num].tar'] and two files for super resolution ['I[interation_num]_E[epoch_num]_gen.pth' and 'I[interation_num]_E[epoch_num]_opt.pth']

write the path/to/super_resolution_weights in the config file [`Image-Super-Resolution-Iterative-Refinement/config/sr_S2_RGB.json`] under ["path"]["resume_state"] field in the form of a sting as `path/to/super_resolution_weights/I[interation_num]_E[epoch_num]`


# Run E2E test
to run the system E2E, use the following command
```
python main.py --config [path/to/super-resolution/config/file] --resume_path [path/to/spectral-extension/model/weights] --model [the type of spectral extension model in use. Choose from 'RCAN', 'FCONV', 'RRDB'] --data_path [path/to/data]
```
the results are saved in a folder named experiments.
# Super Resolution
### Training 
To train the super resolution model run the following command
```
python sr_our.py -c config/sr_S2_RGB.json
```
the config file contains all the information about the test and validation data, model parameters, noise scheduler, testing and training settings. All the hyper-parameters can be changed by changing the coonfig file.
The checkpoints are saved in `Image-Super-Resolution-Iterative-Refinement/experiments`
Note that super resolution only needs Sentinel-2 images for training and testing, therefore the dataset path should be `path/to/data/S2_aligned`
### Inference 
to run the inference on the testing data, run the following command
```
python infr.py -c config/sr_S2_RGB_infr.json
```

# Spectral Extension

### Training
To train the spectral extension model, run the following command
```
cd Spectral-Extension
python train_ae.py --resume_path [path/to/model/resume/the/training/from, None otherwise] --model [type of model, choose from 'RRDB','RCAN','FCONV','AE'] --lr [learning rate]
```
This files saves the results/checkpoints in folder Spectral-Extension/experiments
Note that here you do not have to give the path of the validation data unlike super resolution module. Given the path of the dataset the dataloader performs an 80-20 split with a seed so everytime the dataloader is called the split remains unchanged.

### Testing
run the following commands to perform evaluation
```
python eval.py --resume_path [path/to/model/resume/the/training/from, None otherwise] --model [type of model, choose from 'RRDB','RCAN','FCONV','AE']
```
the final results are saved in Spectral-Extension/eval/.
`[model name].txt` saves the mean and variance of psnr and ssim of all the sentinel-2 bands

# Baseline

### Training 
to train the baselines, run the following commands
```
cd Spectral-Extension
python train_baseline.py --resume_path [path/to/model/resume/the/training/from, None otherwise] --model [type of model, choose from 'RRDB','RCAN','FCONV','AE'] --lr [learning rate]
```
results and checkpoints are saved in Spectral-Extension/experiments_baseline

### Testing
```
python eval_baseline.py --resume_path [path/to/model/resume/the/training/from, None otherwise] --model [type of model, choose from 'RRDB','RCAN','FCONV','AE']
```
the final results are saved in Spectral-Extension/eval_baseline/.
`[model name].txt` saves the mean and variance of psnr and ssim of all the sentinel-2 bands

# Contribute

